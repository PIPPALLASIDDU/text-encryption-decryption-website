<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	  <link rel="stylesheet" href="https://www.w3schools.com/w3css/3/w3.css">
	  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <title>Encryption</title>
    <style> 




.column {
  float: left;
  padding: 40px;
}


.column.side {
  width: 45%;
}


.column.middle {
  width: 10%;
}


.row:after {
  content: "";
  display: table;
  clear: both;
}	 
   </style> 

</head>

<body>

    <!-- <div style="background-image: url('https://i.pinimg.com/originals/c8/9e/68/c89e6809085102dcfa828d4a165a1399.jpg');"> -->
  <div>
	<img  class="ml-2 mt-2 rounded-circle"src="https://i.imgur.com/UAeEKyX.jpg" alt="Logo" width="220" height="160" />	
	
	<h1 class=" mt-2 ml-2"><b>Data Encryption</b></h1>
    	<h4 class="ml-2">Save your privacy using your very own encryption tool</h4>
	<hr />				<!-- For creating a horizontal line -->
	<h1  class="display-4" style="text-align:center"><b>Data Encrypter</b></h1>
	<h4 style="text-align:center"> Enter your encrypted data or upload text file </h4>
	<form>
	<br>
   
	<pre class="ml-2" style="font-size:1.2em">Product of primes(n):<input type="number" class="ml-2 border border-dark" id="n" name="pop" size="15" maxlength="30" /></pre>
	<p  class="ml-2" style="font-size:1em">Encryption Key(private key)e:            <input type="number" class="ml-4 border border-dark" id="enkey" name="enckey" size="15" maxlength="30" /></p>
      <div class="row">
	<div class="column side">
      <textarea  id="inputtxt" name="inputtext" rows="6" cols="50" placeholder="Enter your text here.."></textarea>
	<br>	
	<pre style="font-size:1.3em">	     OR</pre>
	<input type="file" class="ml-2" id="inputfile" name="inputfile" /><br><br>
     </div>
      <div class="column middle">
	<p> </p>
      </div>
     <div class="column side">
      <!-- <textarea   rows="6" cols="50" placeholder="Enter your text here.." > </textarea>  -->
	<h3>Generate key-value pair</h3>
	<input type="button" class="ml-2 btn btn-primary" value="Generate" onclick="generate();"><br><br>
	<b><p id="gnkey" style="font-size:1.3em"></p>
        <p id="genkey" style="font-size:1.3em"></p>
        <p id="gdekey" style="font-size:1.3em"></p></b>
     </div>
     </div>
  	
	<input type="button" class="ml-2 btn btn-primary" value="Encrypt" onclick="encrypt();window.location.href = '#output';"><br>			
	</form>
    
    
	<h2>The Encrypted Text is</h2>
	<p id="output" style="font-size:1.3em"></p>

    	<!-- <a href="Encryption page.html">Page 2</a> -->

   <script>  
	function encrypt()
{
     if(document.getElementById("inputfile").files.length!=0)			//for file
      {
	var n,enkey,m,i,pt,ct,k,len,j,en1=[];
    	var en="";
	n=document.getElementById("n").value;
    	enkey=document.getElementById("enkey").value;
   	
    	var fileToLoad = document.getElementById("inputfile").files[0];
   	var fileReader = new FileReader();
  	fileReader.onload = function(fileLoadedEvent)
	   {
	   m=fileLoadedEvent.target.result;
	   for(i=0;i<m.length;i++)			//to convert m from char to int array
    	 	{
       		 en1[i]=m.charCodeAt(i);
         	}
     	   i=0;
	  while (i != en1.length)
    		 {
       		 pt = en1[i];
       		 pt = pt - 96;
       		 k = 1;
       		 for (j = 0; j < enkey; j++)
          		{
           		 k = k * pt;
           		 k = k % n;
         		 }
       		 ct = k + 96;
        	en = en + ct+" ";
        	i++;
      		}
	  var x=document.getElementById("output");
          x.innerHTML=en;
	  };
    	fileReader.readAsText(fileToLoad, "UTF-8");
    }

  else {
	var n,enkey,m,i,pt,ct,k,len,j,en1=[];
    	var en="";
	n=document.getElementById("n").value;
    	enkey=document.getElementById("enkey").value;
   	m=document.getElementById("inputtxt").value;	   //input as string
    
    for(i=0;i<m.length;i++)			//to convert m from char to int array
    	 {
        en1[i]=m.charCodeAt(i);
         }
     	i=0;
	while (i != en1.length)
    	 {
        pt = en1[i];
        pt = pt - 96;
        k = 1;
        for (j = 0; j < enkey; j++)
          {
            k = k * pt;
            k = k % n;
          }
        ct = k + 96;
        en = en + ct+" ";
        i++;
       }
      var x=document.getElementById("output");
      x.innerHTML=en;
      }
 }


function generate()
    {
    var p, q, n, t, k,flag, e=[], d=[], j, i, enckey,deckey;
    p = primegenerator(75, 200);
    q = primegenerator(73, 205);
    n = p * q;
    t = (p - 1) * (q - 1);
    k = 0;
    for (i = 2; i < t; i++)
      {
        if (t % i == 0)
            continue;
        flag = prime(i,j);
        if (flag == 1 && i != p && i != q)
        {
            e[k] = i;
            flag = cd(e[k],t);
            if (flag > 0)
            {
                d[k] = flag;
                k++;
            }
            if (k == 99)
                break;
        }
      }

    var ee = rand()%20;
    enckey= e[ee];
    deckey= d[ee];
    document.getElementById("gnkey").innerHTML="Product of prime n:"+n;
    document.getElementById("genkey").innerHTML="Encryption key e:"+enckey;
    document.getElementById("gdekey").innerHTML="Decryption key d:"+deckey;
    }
    
   
    function primegenerator(low,high)
	{
    var primearr=[],i,j=0,flag=0,secret;
  
    while (low < high)
    {
        flag = 0;
        for(i = 2; i <= low/2; ++i)
        {
            if(low % i == 0)
            {
                flag = 1;
                break;
            }
        }
        if (flag == 0)
        {
            primearr[j]=low;
            ++j;
        }
        ++low;
    }

    secret = rand() % (j);

    return(primearr[secret]);
	}
    
 
    function rand(min=0, max=32767) 
    {
 	 return Math.floor(Math.random() * (max - min + 1) ) + min;
	}
    
    function prime(pr,j)			
	{
    var i;
    j = Math.sqrt(pr);
    for (i = 2; i <= j; i++)
      {
        if (pr % i == 0)
            return 0;
      }
    return 1;
    }
    
    function cd(x,t)
	{
    var k = 1;
    while (1)
      {
        k = k + t;
        if (k % x == 0)  return (k / x);
      }
	}
	   
   </script> 
   </div> 
   <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

</body>

</html>